"use strict"

var path = require("path");
var assert = require("chai").assert;

// Set module root directory
process.rootAPI = path.join(__dirname, "../../");
process.requireAPI = function(filePath){
  return require(path.normalize(process.rootAPI + "/" + filePath));
};

// Module files
var FakeUserDatabase = require("./database/FakeUserDatabase.js");
var UserProvider = process.requireAPI("lib/providers/UserProvider.js");
var userProvider = new UserProvider(new FakeUserDatabase());

describe("UserProvider", function(){
  
  describe("getUserByCredentials", function(){

    it("should load a user by its credentials", function(done){
      userProvider.getUserByCredentials("openveo", "test", function(error, user){
        assert.isDefined(user);
        assert.isObject(user);
        assert.isDefined(user.username);
        assert.isString(user.username);
        assert.isUndefined(user.password);
        done();
      });
      
    });

  });
  
  describe("getUserById", function(){

    it("should load a user by its id", function(done){
      userProvider.getUserById("54c7a7ded0909a3b3e8d64c4", function(error, user){
        assert.isDefined(user);
        assert.isObject(user);
        assert.isDefined(user.username);
        assert.isString(user.username);
        assert.isUndefined(user.password);
        done();
      });
    });

  });

});
